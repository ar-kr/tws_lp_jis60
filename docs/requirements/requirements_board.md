# 基板の要件

本書では自作左右分割キーボード`tws_lp_jis60`の基板設計に対して求める要件を列挙する．

## 機械的要件

- キースイッチの数，キー幅，配置の全てをsphh jp v2に準拠すること．
- 基板の外形をsphh jp v2に準拠した形状とすること．すなわち，左手側基板の右辺以外3辺と右手側基板の左辺以外3辺は水平/垂直な線であり，左手側基板の右辺と右手側基板の左辺はそれぞれが噛み合うような階段状の形状が求められる．
- （参考）phh jp v2公式サイト: https://abitkeys.com/sphhjp/build_v2.html

## 電子回路要件

### キースイッチ

- キースイッチのホットスワップに対応するため，基板にはソケットのみを半田付けで固定すること．
- 対象のキースイッチは，Kailh Choc v2互換を想定すること．

### マイコン


- マイコンにはxiao系のESP32開発ボードを用いること．
- 開発ボードはコンスル―を用いて取り付け，着脱可能であること．
- ボード選定の際には最低限以下を満たすこと．

  - キー数に対して十分な入出力ピンを持つこと
  - 単体でバッテリ管理機能を搭載していること
  - 単体でBluetooth LEによる通信が行えること
  - 接続端子としてUSB Type-Cを有すること

- 上記以外にも基板レイアウト等に対して適切な条件を適宜定めること．

### インジケータ

- キーボードの内部状態（現在のBT接続状態，電池残量など）を示すためのインジケータランプを有すること．
    - ペアリング先3個+電池残量用1個で合計4個以上のLEDが搭載されているとよい．
- 適切な色のLEDの点灯状態によって上記を示すことを最小要件とする．
- 必要に応じてLCDモジュールを搭載してもよい．

### 電源

- 左右の基板にはそれぞれ独立した電源が取り付けられること
- 使用される電力源は乾電池が最も好ましいが，開発難易度に応じてマイコンボードに直接接続できる充電池を用いてもよい．

### 接続方式

- 通常の使用においてホストマシン（PC, スマートフォン等）との接続にはBluetooth LEを用いること．
- 左右間の通信も無線で行うこと．この接続はファームウェアの機能を適切に利用する想定でよい．
- ただし，キーマップ書き換え時にはマイコンボードに搭載されたUSBポートを利用することを想定してもよい．

## ソフトウェア要件

- ファームウェアのベースとしてZMK Firmwareを用いること
- VIAを用いてキーマップの変更ができること
- （参考）
    - ZMK Firmware公式ページ: https://zmk.dev/docs
    - VIA: https://usevia.app/